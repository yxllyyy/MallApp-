import{o as e,c as t,w as i,a as s,n as r,b as o,r as a,d as n,i as d,e as l,f as c,g as h,h as u,j as m,F as g,k as p,l as f,t as b,m as _,p as w,q as v,s as y,u as C,v as k,x as I,y as x,z as B,A as T}from"./index.bbf2f42f.js";import{_ as q}from"./_plugin-vue_export-helper.cdc0426e.js";import D from"./pages-home-cpns-home-banner.78ae55a6.js";import j from"./components-grid-view-item-grid-view-item.26469312.js";const H=q({name:"UniGridItem",inject:["grid"],props:{index:{type:Number,default:0}},data:()=>({column:0,showBorder:!0,square:!0,highlight:!0,left:0,top:0,openNum:2,width:0,borderColor:"#e5e5e5"}),created(){this.column=this.grid.column,this.showBorder=this.grid.showBorder,this.square=this.grid.square,this.highlight=this.grid.highlight,this.top=0===this.hor?this.grid.hor:this.hor,this.left=0===this.ver?this.grid.ver:this.ver,this.borderColor=this.grid.borderColor,this.grid.children.push(this),this.width=this.grid.width},beforeDestroy(){this.grid.children.forEach(((e,t)=>{e===this&&this.grid.children.splice(t,1)}))},methods:{_onClick(){this.grid.change({detail:{index:this.index}})}}},[["render",function(l,c,h,u,m,g){const p=d;return m.width?(e(),t(p,{key:0,style:o("width:"+m.width+";"+(m.square?"height:"+m.width:"")),class:"uni-grid-item"},{default:i((()=>[s(p,{class:r([{"uni-grid-item--border":m.showBorder,"uni-grid-item--border-top":m.showBorder&&h.index<m.column,"uni-highlight":m.highlight},"uni-grid-item__box"]),style:o({"border-right-color":m.borderColor,"border-bottom-color":m.borderColor,"border-top-color":m.borderColor}),onClick:g._onClick},{default:i((()=>[a(l.$slots,"default",{},void 0,!0)])),_:3},8,["class","style","onClick"])])),_:3},8,["style"])):n("",!0)}],["__scopeId","data-v-0810a0ad"]]);const $=q({name:"UniGrid",emits:["change"],props:{column:{type:Number,default:3},showBorder:{type:Boolean,default:!0},borderColor:{type:String,default:"#D2D2D2"},square:{type:Boolean,default:!0},highlight:{type:Boolean,default:!0}},provide(){return{grid:this}},data:()=>({elId:`Uni_${Math.ceil(1e6*Math.random()).toString(36)}`,width:0}),created(){this.children=[]},mounted(){this.$nextTick((()=>{this.init()}))},methods:{init(){setTimeout((()=>{this._getSize((e=>{this.children.forEach(((t,i)=>{t.width=e}))}))}),50)},change(e){this.$emit("change",e)},_getSize(e){l().in(this).select(`#${this.elId}`).boundingClientRect().exec((t=>{this.width=parseInt((t[0].width-1)/this.column)+"px",e(this.width)}))}}},[["render",function(n,l,c,h,u,m){const g=d;return e(),t(g,{class:"uni-grid-wrap"},{default:i((()=>[s(g,{id:u.elId,ref:"uni-grid",class:r(["uni-grid",{"uni-grid--border":c.showBorder}]),style:o({"border-left-color":c.borderColor})},{default:i((()=>[a(n.$slots,"default",{},void 0,!0)])),_:3},8,["id","class","style"])])),_:3})}],["__scopeId","data-v-257e8068"]]);const E=new class{request(e,t,i){return new Promise(((s,r)=>{c({url:"http://152.136.185.210:7878/api/hy66"+e,method:t||"GET",timeout:6e4,data:i,success(e){s(e.data)},fail(e){r(e)}})}))}get(e,t){return this.request(e,"GET",t)}post(e,t){return this.request(e,"POST",params)}},S=["pop","new","sell"];function G(){let e={};return S.forEach((t=>{e[t]={page:0,list:[]}})),e}const L=h("home",{state:()=>({banners:[],recommends:[],currentType:"pop",goodsList:G()}),actions:{setCurrentType(e){this.currentType=e},async fetchHomeMultidata(){var e;const t=await E.get("/home/multidata",{});this.banners=(null==(e=t.data.banner)?void 0:e.list)||[],this.recommends=t.data.recommend.list||[]},async fetchHomeData(e,t){u("log","at store/home.js:34",e,t);const i=await((e,t)=>E.get("/home/data",{type:e,page:t}))(e,t);this.goodsList[e].list.push(...i.data.list),this.goodsList[e].page=t}}}),M=q({__name:"home-recommend",props:{recommends:{type:Array,default:()=>[]}},emits:["itemClick"],setup:(r,{emit:o})=>(a,n)=>{const l=_,c=d;return e(),t(c,{class:"recommend"},{default:i((()=>[(e(!0),m(g,null,p(r.recommends,(r=>(e(),t(c,{key:r,class:"recommend-item",onClick:e=>function(e){o("itemClick",e)}(r)},{default:i((()=>[s(l,{class:"image",src:r.image,mode:"widthFix"},null,8,["src"]),s(c,{class:"title"},{default:i((()=>[f(b(r.title),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})}},[["__scopeId","data-v-5b40f3e0"]]);const z=q({},[["render",function(r,o){const a=_,n=d;return e(),t(n,{class:"popular"},{default:i((()=>[s(a,{class:"image",src:"/assets/recommend_bg.6119532a.jpg",mode:""})])),_:1})}],["__scopeId","data-v-504db94a"]]),A=q({__name:"tab-control",props:{titles:{type:Array,default:()=>[]}},emits:["tabItemClick"],setup(o,{emit:a}){const n=w(0);return(l,c)=>{const h=v,u=d;return e(),t(u,{class:"tab-control"},{default:i((()=>[(e(!0),m(g,null,p(o.titles,((o,d)=>(e(),t(u,{key:d,class:r(["item",n.value===d?"active":""]),onClick:e=>function(e){n.value=e,a("tabItemClick",e)}(d)},{default:i((()=>[s(h,{class:"title"},{default:i((()=>[f(b(o),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})}}},[["__scopeId","data-v-f7239610"]]),N={__name:"home",setup(r){const o=L(),{banners:a,recommends:n,goodsList:l,currentType:c}=y(o);function h(e){x({url:"/pages/webview/webview?link="+e})}function u(e){o.setCurrentType(S[e])}function f(e){x({url:"/pages/detail/detail?iid="+e.iid})}return C((()=>{o.fetchHomeMultidata(),o.fetchHomeData("pop",1),o.fetchHomeData("new",1),o.fetchHomeData("sell",1)})),k((()=>{var e;o.fetchHomeData(c.value,(null==(e=null==l?void 0:l.value[null==c?void 0:c.value])?void 0:e.page)+1)})),(r,o)=>{const b=B(T("uni-grid-item"),H),_=B(T("uni-grid"),$),w=d;return e(),t(w,{class:"content"},{default:i((()=>[s(D,{banners:I(a),onHandleItemClick:h},null,8,["banners"]),s(M,{recommends:I(n)},null,8,["recommends"]),s(z),s(A,{titles:["流行","新款","精选"],onTabItemClick:u}),s(_,{column:2,highlight:!0,borderColor:"#ff8198",showBorder:!1,square:!1},{default:i((()=>{var r;return[(e(!0),m(g,null,p(null==(r=I(l)[I(c)])?void 0:r.list,((r,o)=>(e(),t(b,{key:r.iid,index:o},{default:i((()=>[s(j,{itemInfo:r,onItemClick:f},null,8,["itemInfo"])])),_:2},1032,["index"])))),128))]})),_:1})])),_:1})}}};export{N as default};
